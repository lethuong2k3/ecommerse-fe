import{j as t,r as m,I as ae,s as ne,d as se,t as ie,v as H,w as oe,x as re,y as ce,L as R,B as D,z as le,S as de,l as ue,A as pe,D as me,_ as b,E as he,G as ye,J as ge,K as xe,N as fe,H as _e,M as T,R as O,h as ve,U as je,V as Se,W as Le,Q as Ce,n as G,X as ze,Y as be,Z as we,e as Re,$ as Ne,a0 as Pe,a1 as Ie,a2 as De,a3 as qe}from"./index-Cu8jBkmA.js";import{P as We}from"./PaymentMethods-DSPI0RFI.js";import{A as Be}from"./index-uOorrhlD.js";import"./index-CxtjtUM0.js";const Ee="_container_en5z3_1",Me="_navigateSection_en5z3_4",ke="_previousPage_en5z3_15",Fe="_breadcrumb_en5z3_18",Te="_containerRelatedProduct_en5z3_22",Oe="_contentSection_en5z3_25",Ge="_imageBox_en5z3_31",Ae="_sliderCommon_en5z3_49",Ve="_infoBox_en5z3_59",He="_price_en5z3_69",Qe="_des_en5z3_73",$e="_functionInfo_en5z3_90",Ue="_boxBtn_en5z3_97",Ke="_labelQty_en5z3_100",Ye="_boxOr_en5z3_106",Xe="_line_en5z3_115",Je="_addFunction_en5z3_121",Ze="_info_en5z3_59",et="_lableRelatedProduct_en5z3_165",tt="_containerInfo_en5z3_171",at="_itemInfo_en5z3_177",nt="_title_en5z3_188",st="_content_en5z3_25",it="_containerReview_en5z3_195",ot="_reviewList_en5z3_195",rt="_boxContent_en5z3_202",ct="_stars_en5z3_212",lt="_updateReview_en5z3_222",dt="_replyForm_en5z3_230",ut="_commentReplyTitle_en5z3_233",pt="_commentNotes_en5z3_240",mt="_commentFormCookiesConsent_en5z3_250",ht="_btnSubmit_en5z3_258",yt="_inputGroup_en5z3_263",gt="_boxItemStar_en5z3_274",xt="_active_en5z3_283",ft="_btnClear_en5z3_305",_t="_noRelatedProducts_en5z3_313",o={container:Ee,navigateSection:Me,previousPage:ke,breadcrumb:Fe,containerRelatedProduct:Te,contentSection:Oe,imageBox:Ge,sliderCommon:Ae,infoBox:Ve,price:He,des:Qe,functionInfo:$e,boxBtn:Ue,labelQty:Ke,boxOr:Ye,line:Xe,addFunction:Je,info:Ze,lableRelatedProduct:et,containerInfo:tt,itemInfo:at,title:nt,content:st,containerReview:it,reviewList:ot,boxContent:rt,stars:ct,updateReview:lt,replyForm:dt,commentReplyTitle:ut,commentNotes:pt,commentFormCookiesConsent:mt,btnSubmit:ht,inputGroup:yt,boxItemStar:gt,active:xt,btnClear:ft,noRelatedProducts:_t};function vt(){const c=[{id:1,title:"Size",content:"S, M, L"},{id:2,title:"Chất liệu",content:"Fleece"},{id:3,title:"Màu sắc",content:"Black, Blue"}];return t.jsx("div",{className:o.containerInfo,children:c.map((h,l)=>t.jsxs("div",{className:o.itemInfo,children:[t.jsx("div",{className:o.title,children:h.title}),t.jsx("div",{className:o.content,children:h.content})]},l))})}function A({label:c,typeChildren:h,isRequired:l,handleChooseStar:p,selectedStar:x,formik:u}){const[r,s]=m.useState(null),d=()=>{switch(h){case"rating":return t.jsx("div",{className:o.boxItemStar,children:Array.from({length:5},(_,e)=>{const n=r!==null?e<r:e<x;return t.jsx(ne,{size:20,className:se(o.starIcon,{[o.active]:n}),onMouseEnter:()=>s(e+1),onMouseLeave:()=>s(null),onClick:()=>p(e)},e)})});case"textarea":return t.jsx(ae,{id:"comment",type:"textarea",rows:5,formik:u})}};return t.jsxs("div",{className:o.inputGroup,children:[t.jsxs("label",{children:[c," ",l&&t.jsx("span",{children:"*"})," "]}),d()]})}const jt=async c=>ie.get(`/reviews/${c}`),St=async c=>H.get(`/user/review/${c}`),Lt=async c=>H.post("/review/create",c);function Ct({toast:c,userId:h,setIsOpen:l,setType:p,data:x,apiGetReviews:u,apiGetReview:r,reviews:s,userImg:d,isLoadingReviews:_,isReview:e}){const[n,v]=m.useState(0),[y,S]=m.useState(!1),C=j=>{v(j+1)},z=oe({initialValues:{comment:""},validationSchema:re({comment:ce().max(200,"Nội dung đánh giá không được vượt quá 200 ký tự")}),onSubmit:async j=>{if(!y){if(!h){l(!0),p("login"),c.warning("Vui lòng đăng nhập");return}if(n===0){c.warning("Vui lòng chọn đánh giá sao");return}S(!0),Lt({product:x,rating:n,comment:j.comment}).then(L=>{u(),r(),c.success("Gửi đánh giá thành công"),S(!1),z.resetForm(),v(0)}).catch(L=>{S(!1),console.log(L)})}}});return t.jsxs("div",{className:o.containerReview,children:[_&&t.jsx(R,{}),s.length===0?t.jsx("p",{children:"Không có đánh giá."}):t.jsx("ul",{className:o.reviewList,children:s.map((j,L)=>t.jsx("li",{children:t.jsxs("div",{className:o.boxContent,children:[t.jsx("img",{src:d}),t.jsxs("div",{children:[t.jsx("p",{children:j.userName}),t.jsxs("div",{className:o.stars,children:["★".repeat(j.rating),"☆".repeat(5-j.rating)]}),t.jsx("p",{children:j.comment})]})]})},L))}),!e&&t.jsxs("div",{className:o.replyForm,children:[t.jsx("div",{className:o.commentReplyTitle,children:'ĐÁNH GIÁ CỦA BẠN VỀ SẢN PHẨM "10K YELL"'}),t.jsxs("form",{onSubmit:z.handleSubmit,children:[t.jsx(A,{label:"Đánh giá sao",isRequired:!0,typeChildren:"rating",handleChooseStar:C,selectedStar:n}),t.jsx(A,{label:"Nội dung đánh giá",isRequired:!0,typeChildren:"textarea",formik:z}),t.jsx("div",{className:o.btnSubmit,children:t.jsx(D,{content:"Gửi",type:"sumbit"})})]})]})]})}function zt(c,h,l){let p=1,x=1;const u=typeof c=="string"?document.querySelector(c):c;if(!u)throw new Error("containerElement is not found");const r=typeof h=="string"?u.querySelector(h):h;if(!r)throw new Error("imageElement is not found");const s=typeof l=="string"?u.querySelector(l):l;if(!s)throw new Error("imageOriginalEl is not found");const d=()=>{s&&(s.style.width=s.naturalWidth+"px",s.style.height=s.naturalHeight+"px",p=s.naturalWidth/u.clientWidth-1,x=s.naturalHeight/u.clientHeight-1)};return s.addEventListener("load",d),u.addEventListener("mouseenter",()=>{r.style.opacity="0"}),u.addEventListener("mouseleave",()=>{r.style.opacity="1"}),u.addEventListener("mousemove",_=>{s.style.top=-_.offsetY*x+"px",s.style.left=-_.offsetX*p+"px"}),d(),d}var Q={exports:{}},w={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V;function bt(){if(V)return w;V=1;var c=le,h=Symbol.for("react.element"),l=Symbol.for("react.fragment"),p=Object.prototype.hasOwnProperty,x=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function r(s,d,_){var e,n={},v=null,y=null;_!==void 0&&(v=""+_),d.key!==void 0&&(v=""+d.key),d.ref!==void 0&&(y=d.ref);for(e in d)p.call(d,e)&&!u.hasOwnProperty(e)&&(n[e]=d[e]);if(s&&s.defaultProps)for(e in d=s.defaultProps,d)n[e]===void 0&&(n[e]=d[e]);return{$$typeof:h,type:s,key:v,ref:y,props:n,_owner:x.current}}return w.Fragment=l,w.jsx=r,w.jsxs=r,w}Q.exports=bt();var I=Q.exports;const wt=({srcPreview:c,srcOriginal:h,width:l=400,height:p=600,className:x=""})=>{const u=m.useRef(null),r=m.useRef(null),s=m.useRef(null),d=m.useRef(()=>{});return m.useEffect(()=>{u.current&&r.current&&s.current&&(d.current=zt(u.current,r.current,s.current))},[]),m.useEffect(()=>{d.current()},[h,c,l,p]),I.jsxs("div",{ref:u,className:x,style:{position:"relative",overflow:"hidden",width:l?l+"px":"100%",height:p?p+"px":"100%"},children:[I.jsx("img",{ref:r,src:c,alt:"",style:{position:"relative",zIndex:"1",objectFit:"cover",width:"100%",height:"100%",transitionProperty:"opacity",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"300ms"}}),I.jsx("img",{ref:s,src:h,alt:"",style:{position:"absolute",maxWidth:"none"}})]})},Rt="/assets/user-D0m93DkQ.jpg";function qt(){var B,E,M,k,F;const{handleGetListProductsCart:c,listProductCart:h,setIsOpen:l,setType:p,handleGetListCompare:x,handleGetListWishList:u}=m.useContext(de),{toast:r}=m.useContext(ue),{userId:s}=m.useContext(pe),d={menuSelected:1,relatedProduct:[],sizeSelected:"",colorSelected:"",data:{},dataDetail:null,isLoadingDetail:!1,isLoadingProducts:!1,quantity:1,isLoadingCart:!1,isLoadingCompare:!1,isLoadingWList:!1,isWishList:{},isCompare:{},reviews:[],isLoadingReviews:!1,isReview:{}};function _(a,i){return{...a,[i.type]:i.payload}}const[e,n]=m.useReducer(_,d),v=me(),y=h==null?void 0:h.filter(a=>{var i;return a.productDetail.id===((i=e.dataDetail)==null?void 0:i.id)})[0],S=m.useMemo(()=>{var i;return b.uniq(b.map((i=e.data)==null?void 0:i.productDetails,"size.name"))},[e.data]),C=m.useMemo(()=>{var i,g;return b.uniqBy((g=(i=e.data)==null?void 0:i.productDetails)==null?void 0:g.map(({color:f})=>({hex:f.hex,name:f.name})),"hex")},[e.data]),z=m.useMemo(()=>{var a,i;return e.colorSelected?b.uniq((i=(a=e.data)==null?void 0:a.productDetails)==null?void 0:i.filter(g=>g.color.hex===e.colorSelected.hex).map(g=>g.size.name)):S},[e.colorSelected,e.data]),j=m.useMemo(()=>{var a,i;return e.sizeSelected?b.uniqBy((i=(a=e.data)==null?void 0:a.productDetails)==null?void 0:i.filter(g=>g.size.name===e.sizeSelected).map(g=>({hex:g.color.hex,name:g.color.name})),"hex"):C},[e.sizeSelected,e.data]),L=a=>{n({type:"colorSelected",payload:a})},$=a=>{n({type:"sizeSelected",payload:a})},U=()=>{n({type:"sizeSelected",payload:""}),n({type:"colorSelected",payload:""}),n({type:"quantity",payload:1}),n({type:"dataDetail",payload:null})},K=()=>{if(!s){l(!0),p("login"),r.warning("Vui lòng đăng nhập");return}if(!e.sizeSelected){r.warning("Vui lòng chọn size");return}if(!e.colorSelected){r.warning("Vui lòng chọn màu sắc");return}const a={orderItems:[{productDetail:e.dataDetail,quantity:e.quantity}]};n({type:"isLoadingCart",payload:!0}),Ne(a).then(i=>{if(i.data.errors){console.log(i.data.errors),r.error(i.data.errors[400]),c(s),n({type:"isLoadingCart",payload:!1});return}l(!0),p("cart"),r.success("Thêm vào giỏ thành công"),n({type:"isLoadingCart",payload:!1}),c(s)}).catch(i=>{console.log(i),n({type:"isLoadingCart",payload:!1})})},Y=()=>{if(!s){l(!0),p("login"),r.warning("Vui lòng đăng nhập");return}n({type:"isLoadingCompare",payload:!0}),e.isCompare.status===1?Pe(e.isCompare.id).then(a=>{x(s),P(),n({type:"isLoadingCompare",payload:!1})}).catch(a=>{n({type:"isLoadingCompare",payload:!1}),console.log(a)}):Ie({product:e.data}).then(a=>{l(!0),p("compare"),r.success("Thêm sản phẩm vào mục so sánh"),n({type:"isLoadingCompare",payload:!1}),x(s),P()}).catch(a=>{n({type:"isLoadingCompare",payload:!1}),console.log(a)})},X=async()=>{if(!s){l(!0),p("login"),r.warning("Vui lòng đăng nhập");return}if(n({type:"isLoadingWList",payload:!0}),e.isWishList.status===1)De(e.isWishList.id).then(a=>{u(s),N(),n({type:"isLoadingWList",payload:!1})}).catch(a=>{console.log(a),n({type:"isLoadingWList",payload:!1})});else{const a={product:{id:e.data.id}};qe(a).then(i=>{l(!0),p("wishlist"),r.success("Thêm sản phẩm vào mục yêu thích"),n({type:"isLoadingWList",payload:!1}),u(s),N()}).catch(i=>{n({type:"isLoadingWList",payload:!1}),console.log(i)})}};m.useEffect(()=>{v.id&&(n({type:"isLoadingDetail",payload:!0}),he(v.id).then(a=>{n({type:"data",payload:a.data.data}),n({type:"isLoadingDetail",payload:!1})}).catch(a=>{console.log(a),n({type:"isLoadingDetail",payload:!1})}))},[v]),m.useEffect(()=>{var a,i;if(Object.keys(e.data).length!==0){const g={category:(a=e.data)==null?void 0:a.category,limit:10,productId:(i=e.data)==null?void 0:i.id};q(),n({type:"dataDetail",payload:null}),n({type:"isReview",payload:""}),ye(g).then(f=>{n({type:"relatedProduct",payload:f.data.data}),n({type:"isLoadingProducts",payload:!1})}).catch(f=>{n({type:"isLoadingProducts",payload:!1}),console.log(f)}),s&&(N(),P(),W())}},[e.data,s]),m.useEffect(()=>{var a,i;if(e.colorSelected&&e.sizeSelected){let g=(i=(a=e.data)==null?void 0:a.productDetails)==null?void 0:i.filter(f=>f.size.name===e.sizeSelected&&f.color.hex===e.colorSelected.hex)[0];ge(g.id).then(f=>{n({type:"dataDetail",payload:f.data.data}),s&&c(s)}).catch(f=>{console.log(f)})}},[e.sizeSelected,e.colorSelected]);const N=()=>{n({type:"isLoadingWList",payload:!0}),xe({product:e.data}).then(a=>{n({type:"isWishList",payload:a.data}),n({type:"isLoadingWList",payload:!1})}).catch(a=>{console.log(a),n({type:"isLoadingWList",payload:!1})})},P=()=>{n({type:"isLoadingCompare",payload:!0}),fe({product:e.data}).then(a=>{n({type:"isCompare",payload:a.data}),n({type:"isLoadingCompare",payload:!1})}).catch(a=>{console.log(a),n({type:"isLoadingCompare",payload:!1})})},q=()=>{n({type:"isLoadingReviews",payload:!0}),jt(e.data.id).then(a=>{n({type:"reviews",payload:a.data}),n({type:"isLoadingReviews",payload:!1})}).catch(a=>{console.log(a),n({type:"isLoadingReviews",payload:!1})})},W=()=>{n({type:"isLoadingReviews",payload:!0}),St(e.data.id).then(a=>{n({type:"isReview",payload:a.data}),n({type:"isLoadingReviews",payload:!1})}).catch(a=>{n({type:"isLoadingReviews",payload:!1})})},J=[{id:1,titleMenu:"Thông tin chi tiết",content:t.jsx(vt,{})},{id:2,titleMenu:`Đánh giá (${e.reviews.length})`,content:t.jsx("div",{children:t.jsx(Ct,{toast:r,userId:s,setIsOpen:l,setType:p,data:e.data,apiGetReviews:q,apiGetReview:W,reviews:e.reviews,userImg:Rt,isLoadingReviews:e.isLoadingReviews,isReview:e.isReview})})}],Z=a=>{if(e.menuSelected===a){n({type:"menuSelected",payload:0});return}n({type:"menuSelected",payload:a})},ee=()=>{e.quantity<=1||n({type:"quantity",payload:e.quantity-1})},te=()=>{var a,i;if(!e.sizeSelected){r.warning("Vui lòng chọn size");return}if(!e.colorSelected){r.warning("Vui lòng chọn màu sắc");return}e.quantity<((a=e.dataDetail)==null?void 0:a.amount)&&(!y||e.quantity<+((i=e.dataDetail)==null?void 0:i.amount)-+(y==null?void 0:y.quantity))&&n({type:"quantity",payload:e.quantity+1})};return t.jsxs("div",{children:[t.jsx(_e,{}),t.jsx(T,{}),e.isLoadingDetail?t.jsx("div",{children:"...Loading"}):t.jsx("div",{className:o.container,children:t.jsxs(T,{children:[t.jsxs("div",{className:o.navigateSection,children:[t.jsxs("div",{className:o.breadcrumb,children:["Trang chủ >"," ",t.jsx("span",{style:{color:"#000"},children:e.data.category&&e.data.category.name})]}),t.jsxs("div",{className:o.previousPage,style:{cursor:"pointer"},children:[" ","< Quay lại trang trước đó"]})]}),t.jsxs("div",{className:o.contentSection,children:[t.jsx("div",{className:o.imageBox,children:(B=e.data.images)==null?void 0:B.map(a=>t.jsx(wt,{width:295,height:350,srcPreview:a.url,srcOriginal:a.url},a.id))}),t.jsx("div",{className:o.sliderCommon,children:e.data.images&&t.jsx(O,{data:e.data.images})}),t.jsxs("div",{className:o.infoBox,children:[t.jsx("h1",{children:e.data.name}),t.jsx("p",{className:o.price,children:e.dataDetail?ve(e.dataDetail.price):je(e.data.productDetails)}),t.jsx("p",{className:o.des,children:e.data.description}),t.jsxs("p",{children:["Size ",e.sizeSelected]}),t.jsx(Se,{isViewProduct:!0,handleChooseSize:$,sizes:S,sizeChoose:e.sizeSelected,disabledSizes:e.colorSelected?S.filter(a=>!z.includes(a)):[]}),t.jsxs("p",{children:["Màu sắc ",e.colorSelected.name]}),t.jsx(Le,{colors:C,colorChoose:e.colorSelected,style:{justifyContent:"flex-start"},handleChooseColor:L,disabledColors:e.sizeSelected?C.filter(a=>!j.find(i=>i.hex===a.hex)):[]}),e.sizeSelected||e.colorSelected?t.jsx("div",{className:o.btnClear,onClick:()=>U(),children:"chọn lại"}):"",t.jsxs("div",{className:o.functionInfo,children:[t.jsx("div",{children:t.jsx(Ce,{item:e.data,quantity:e.quantity,increment:te,decrement:ee,productDetail:e.dataDetail,productDetailCart:y})}),t.jsx("div",{className:o.boxBtn,children:t.jsx(D,{content:t.jsxs(t.Fragment,{children:[e.isLoadingCart&&t.jsx(R,{}),t.jsx(G,{})," ",t.jsx("div",{children:"Thêm vào giỏ"})]}),disabled:!e.sizeSelected||!e.colorSelected||+((E=e.dataDetail)==null?void 0:E.amount)-+(y==null?void 0:y.quantity)===0||e.isLoadingCart,onClick:()=>K()})})]}),e.dataDetail&&t.jsxs("div",{className:o.labelQty,children:["Số lượng tồn kho:"," ",e.dataDetail.amount]}),t.jsxs("div",{className:o.boxOr,children:[t.jsx("div",{className:o.line}),t.jsx("div",{children:"OR"}),t.jsx("div",{className:o.line})]}),t.jsx("div",{children:t.jsx(D,{content:t.jsxs(t.Fragment,{children:[t.jsx(G,{})," ",t.jsx("div",{children:"Mua ngay"})]}),disabled:!e.sizeSelected||!e.colorSelected||+((M=e.dataDetail)==null?void 0:M.amount)-+(y==null?void 0:y.quantity)===0})}),t.jsxs("div",{className:o.addFunction,children:[t.jsx("div",{onClick:()=>X(),children:e.isLoadingWList?t.jsx(R,{}):e.isWishList.status===1?t.jsx(ze,{}):t.jsx(be,{})}),t.jsx("div",{onClick:()=>Y(),children:e.isLoadingCompare?t.jsx(R,{}):t.jsx(we,{})})]}),t.jsx("div",{children:t.jsx(We,{})}),t.jsxs("div",{className:o.info,children:[t.jsxs("div",{children:["Thương hiệu:"," ",t.jsx("span",{children:(k=e.data.brand)==null?void 0:k.name})]}),t.jsxs("div",{children:["SKU: ",t.jsx("span",{children:e.data.sku})]}),t.jsxs("div",{children:["Thể loại:",t.jsxs("span",{children:[" ",(F=e.data.category)==null?void 0:F.name]})]})]}),J.map((a,i)=>t.jsx(Be,{titleMenu:a.titleMenu,contentJsx:a.content,onClick:()=>Z(a.id),isSelected:e.menuSelected===a.id},i))]})]}),t.jsxs("div",{className:o.containerRelatedProduct,children:[t.jsx("h2",{className:o.lableRelatedProduct,children:"Sản phẩm tương tự"}),e.isLoadingProducts?t.jsx("div",{children:"...Loading"}):e.relatedProduct.length>0?t.jsx(O,{data:e.relatedProduct,isProductItem:!0,showItem:4}):t.jsx("div",{className:o.noRelatedProducts,children:"Không có sản phẩm tương tự nào."})]})]})}),t.jsx(Re,{})]})}export{qt as default};
